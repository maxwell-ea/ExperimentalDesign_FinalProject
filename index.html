<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HAT Study Game</title>

    <!-- Link to CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Google Fonts: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&display=swap" rel="stylesheet">
</head>

<body>

<!-- Load sha256 first -->
<script src="node_modules/js-sha256/build/sha256.min.js"></script>

<!-- Then your ES module code -->
<script type="module" src="js/logger.js"></script>

<!-- Start / Title Screen -->
<div id="startScreen" style="display: block; text-align: left; padding: 20px; max-width: 600px; margin: auto;">
    <h1 style="text-align: center; margin-bottom: 20px;">The Mad HATter Study</h1>

    <div class="info-section">
        <h2>Objective of This Study</h2>
        <p>We want to explore how humans and AI work collaboratively as Human-Agent Teams (HATs), through a word association game.</p>
    </div>

    <div class="info-section">
        <h2>1. What You Will Do</h2>
        <ul>
            <li>You will play a short two-player game with an AI teammate.</li>
            <li>During the game, the AI may make mistakes.</li>
            <li>You will be asked to answer a few questions about your experience afterward.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>2. What Data We Collect</h2>
        <ul>
            <li>Your in-game actions and choices.</li>
            <li>Your responses to questions or ratings about the AI.</li>
            <li>Demographic info (e.g., age, computer experience).</li>
            <li>Your name for matching the game data to your survey data.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>3. Benefits</h2>
        <ul>
            <li>Your participation is a contribution to research on human-AI collaboration.</li>
            <li>This research gives us a better understanding of AI communication and social acceptance.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>4. Voluntary Participation</h2>
        <ul>
            <li><b>Participation is completely voluntary.</b> You may stop at any time without penalty.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>5. Privacy & Data Security</h2>
        <ul>
            <li>Your data will be anonymized, once data collection is complete, and stored securely.</li>
            <li>Only the research team will access the data.</li>
            <li>Results may be published in aggregate for classroom purposes, with no identifying info.</li>
        </ul>
    </div>

    <div style="text-align: center; margin-top: 20px;">
        <button id="startExperimentBtn" class="btn">Begin the Study</button>
    </div>
</div>

<!-- Consent Screen -->
<div id="consentScreen" style="display: none; text-align: left; padding: 20px; max-width: 600px; margin: auto;">
    <h2>Participant Information & Consent</h2>
    <form id="participantForm">
        <label>First Name: <input type="text" id="firstName"></label><br><br>
        <label>Last Name: <input type="text" id="lastName"></label><br><br>
        <label>
            <input type="checkbox" id="consentCheckbox">
            I have read the information on the previous page, and I consent to participate in this study.
        </label><br><br>
        <div style="display: flex; justify-content: space-between; max-width: 300px;">
            <button id="backToStartBtn" class="btn">Back</button>
            <button id="consentContinueBtn" class="btn" disabled>Continue</button>
        </div>
    </form>
</div>

<!-- Starting Survey Screen -->
<div id="startSurveyScreen" style="display: none; text-align: center; padding: 20px; max-width: 600px; margin: auto;">
    <h2>Initial Survey</h2>
    <p>Please fill out the intial survey questions. You will continue to use this form throughout the experiment to
        answer questions about your experience. <br><br>
        Access the survey here: <a href="https://docs.google.com/forms/d/e/1FAIpQLScK3sKW-dwODj4pO66I3w_-NzyNVYjgepkN-V3sdlCkIqnjtA/viewform"
                                   target="_blank">survey link.</a> (Click, and it will open a new tab with the survey.)
    </p>
    <button id="confirmSurveyOpenedBtn" class="btn">I have opened the survey</button>
    <button id="startSurveyContinueBtn" class="btn" style="display:none;">Continue</button>
</div>

<!-- Instructions Screen -->
<div id="instructionsScreen" style="display: none; text-align: left; padding: 20px; max-width: 700px; margin: auto;">
    <h1 style="text-align: center; margin-bottom: 20px;">Game Instructions</h1>

    <div class="info-section">
        <h2>üéÆ How the Game Works</h2>
        <ul>
            <li>Each game, you‚Äôll see a 4 √ó 4 grid containing 16 words.</li>
            <li>Each word secretly belongs to one of three categories:
                <ul>
                    <li>Blue words (solid border): gain points üíô</li>
                    <li>Red words (dashed border): lose points ‚ùå</li>
                    <li>Gray words (dotted border): no effect on your score ‚ö™Ô∏èÔ∏è</li>
                </ul>
            </li>
        </ul>
        You won‚Äôt know which words are which ‚Äî only your autonomous teammate will.
    </div>

    <div class="info-section">
        <h2>üí¨ Your Teammate‚Äôs Clues</h2>
        <ul>
            <li>Each turn, your teammate gives you a clue: one word followed by a number.
            </li>
        </ul>

        <em> Example: Calm 4 </em>

        <ul><li>The word describes and connects several related words on the grid.</li>
            <li>The number tells you how many words your teammate is referring to.</li>
        </ul>


    </div>

    <div class="info-section">
        <h2>üéØ Your Task</h2>
        <ul>
            <li>Pick words from the board based on the clue.</li>
            <li>Try to find the blue words to earn points and avoid the red ones.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>üß† Example</h2>
        <ul>
            <li>Good clue: ‚ÄúCalm 4‚Äù ‚Üí River, Garden, Breeze, Violin (all blue and related to ‚Äúcalm‚Äù).</li>
            <li>Risky clue: ‚ÄúStatue 2‚Äù ‚Üí might point to Library and Garden (blue words), but could also make you choose Marble (a red word).</li>
        </ul>
    </div>

    <div class="info-section">
        <h2>üèÜ Goal</h2>
        <ul>
            <li>Earn the highest score possible by interpreting your teammate‚Äôs clues correctly.</li>
        </ul>
    </div>

    <div class="info-section">
        <h2> ‚õîÔ∏è Important Logistics</h2>
        <ul>
            <li>There will be 1 practice game followed by 9 real games. </li>
            <li>You will play with 3 different autonomous teammates, each one for 3 games in a row. </li>
            <li>All of your responses will be confidential and anonymized once data collection is complete.</li>
            <li><b>Reminder:</b> Your participation is optional, and you may exit the game and surveys at any time.</li>
        </ul>
    </div>

    <div style="display: flex; justify-content: space-between; margin-top: 20px; max-width: 300px;">
        <button id="instructionsContinueBtn" class="btn">Continue</button>
    </div>
</div>

<!-- Tutorial Screen -->
<div id="tutorialScreen" style="display: none; text-align: left; padding: 20px; max-width: 700px; margin: auto;">
    <h1 style="text-align: center; margin-bottom: 20px;">Game Tutorial</h1>

    <div class="info-section">
        <h2>üü¶ Start of the Board</h2>
        <p>Here‚Äôs what the board looks like at the start of a round! None of the words are revealed yet, and you will have 2 minutes to try and guess all the right words. <br> <br> </p>
        Two minutes was more than enough time for all our pilot testers, so don't freak out about being timed and just go at your own pace. It's not for a grade! üòâ<br> <br>
        <img src="assets/start_game.png" alt="Board at game start" style="width:100%; max-width:500px; margin: 0px auto; display: block;" >
    </div>

    <div class="info-section">
        <h2>üí° Guessing Words</h2>
        <p>Your teammate gives a clue ‚Äî a word plus a number ‚Äî then you click the card to flip words you think match. You can only choose the number of cards as the number given in the clue. <br> <br>
            Once you run out of choices for a clue, click "Next Clue", which will flash, for the next clue. <br> <br>
        </p>
        <img src="assets/clues_flips.png" alt="Board with clue and blue words" style="width:100%; max-width:500px; margin: 0px auto; display: block;" >
    </div>

    <div class="info-section">
        <h2>ü§® Confusing Clues</h2>
        <p>If a teammate gives you a clue that you don't understand or think is unclear, you can click "Next Clue" to choose the next clue. You can also choose less words than the number given and click "Next Clue" when you aren't sure about the remaining words that go with that clue. <br> <br>
            In this example, the clue given was "Orchard (2)". Apple was chosen, but the second word was unclear. In this case, you can move on to the next clue with "Next Clue". <br> <br> </p>
        <img src="assets/confusing_clues.png" alt="Board with clue and only 1 of 2 words flipped." style="width:100%; max-width:500px; margin: 0px auto; display: block;" >
    </div>

    <div class="info-section">
        <h2>‚ùå Mistakes & Apologies</h2>
        <p>Some words are good, some are neutral, and some are bad. If you pick a wrong word, your teammate might apologize for the unclear clue. You‚Äôll then respond using the emoji panel to tell them how you feel about their apology. They are numbered 1-5 to represent "very happy" to "very displeased". <br> <br> </p>
        <img src="assets/mistakes_apologies.png" alt="Board with wrong answer flipped, apology, and emojis" style="width:100%; max-width:500px; margin: 0px auto; display: block;" >
    </div>

    <div style="display: flex; justify-content: space-between; margin-top: 20px; max-width: 300px;">
        <button id="tutorialContinueBtn" class="btn">Start Practice Game ‚Üí</button>
    </div>
</div>

<!-- Practice Board Survey -->
<div id="practiceSurveyScreen" style="display:none; text-align:center; padding:20px;">
    <h2>Tutorial Survey</h2>
    <p>Answer a few questions about the tutorial board. This short tutorial survey is like those you will see during the experiment.</p>
    <button id="practiceSurveyContinueBtn" class="btn">Continue</button>

    <!-- Confirmation overlay -->
    <div id="practiceSurveyConfirm" style="display:none; margin-top: 10px;">
        <p>Are you ready to begin the first round?</p>
        <button id="practiceSurveyConfirmYes" class="btn">Yes</button>
        <button id="practiceSurveyConfirmNo" class="btn">No</button>
    </div>
</div>

<!-- Board Screen -->
<div id="boardScreen" style="display: none;">
    <div id="status" style="margin-bottom: 15px; font-weight: 500;">Round 1 ‚Äî Board 1</div>
    <div id="app"><!-- Board will appear here --></div>
    <button id="nextBtn" class="btn">Next Clue</button>
</div>

<!-- Mini Survey Screen -->
<div id="miniSurveyScreen" style="display: none; text-align: center; padding: 20px;">
    <h2>Board Review</h2>
    <p>Please answer the two questions related to your experience with the game you just completed. <br>
        Click "Continue" when you've answered the questions and are ready to begin the next game.</p>
    <button id="miniSurveyContinueBtn" class="btn">Continue</button>

    <!-- Confirmation overlay -->
    <div id="miniSurveyConfirm" style="display:none; margin-top: 10px;">
        <p>Are you ready to continue to the next board?</p>
        <button id="miniSurveyConfirmYes" class="btn">Yes</button>
        <button id="miniSurveyConfirmNo" class="btn">No</button>
    </div>
</div>

<!-- Medium Survey Screen -->
<div id="mediumSurveyScreen" style="display: none; text-align: center; padding: 20px;">
    <h2>Board Review and End of Round Survey</h2>
    <p>Please answer the two questions related to your experience with the game you just completed, and fill out the short survey for this round. <br> <br>
        Click "Continue" when you have completed the survey and are ready to start the next round

    </p>
    <button id="mediumSurveyContinueBtn" class="btn">Continue</button>

    <div id="mediumSurveyConfirm" style="display:none; margin-top: 10px;">
        <p>Are you ready to continue to the next board?</p>
        <button id="mediumSurveyConfirmNo" class="btn">No</button>
        <button id="mediumSurveyConfirmYes" class="btn">Yes</button>
    </div>
</div>

<!-- Final Survey Screen -->
<div id="finalSurveyScreen" style="display: none; text-align: center; padding: 20px;">
    <h2>Final Survey</h2>
    <p>Please fill out the End of Round Survey for the final teammate and the Mad HATter Closeout Survey.  <br>
        Click "Finish" when done.</p>
    <button id="finalSurveyContinueBtn" class="btn">Finish</button>

    <div id="finalSurveyConfirm" style="display:none; margin-top: 10px;">
        <p>Are you ready to end the experiment?</p>
        <button id="finalSurveyConfirmYes" class="btn">Yes</button>
        <button id="finalSurveyConfirmNo" class="btn">No</button>
    </div>
</div>

<!-- Final Screen -->
<div id="finalScreen" style="display: none; text-align: center; padding: 20px;">
    <h2>Thank you!</h2>
    <p>You have finished the experiment! ü•≥</p>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>